
os의 사용자는 os가 마치 하나의 프로세스만 실행하는 것 처럼 보이지만 실상은 그렇지 않다.
os는 한순간에도 수면 아래의 백조의 발처럼 백그라운드에서 수개의 프로세스를 돌리고 있다.
![[Pasted image 20231002193920.png]]
예를 들어 위의 상황에서 무한루프를 돌고있는 process A 가 printf(a)를 실행하기를 원하고, process B가 printf(b)를 중간에 실행하기를 원한다면, process B 는 process a의 무한루프가 끝날때 까지 기다리는것이 아니라, process A가 어느정도의 cpu시간을 사용하고 나면 os에서 개입해서 process b를 실행하도록 한다. 

![[Pasted image 20231002192613.png]]
여기서 fork라는 시스템콜이 사용되는데, fork는 현재 진행중인 프로세스를 그대로 복제하여 실행하는 자식 프로세스를 만드는 함수이다. 
위의 코드같은 경우 fork()함수 뒤의 코드들과 메모리를 그대로 복제한 자식 process를 만든다.
복제된 프로세스는 pid(parent process id)값을 반환하는데 부모 프로세스의 경우 0, 자식프로세스인경우 1이상의 값을 반환하기 때문에, 분기를 사용하여 여러개의 프로세스를 병렬적으로 실행할 수 있게 함.
![[Pasted image 20231002194432.png]]
fork는 부모 프로세스의 변수 메모리 까지 복사한다고 해서 서로 영향을 미치는것이 아닌가 걱정했었는데 ![[Pasted image 20231002194634.png]]
실제로 복사를 해서 공유하지만 프로세스를 수정하려고 하는순간 메모리를 복제해서 나눠갖기 때문에 괜춘하다고 한다.