
2계층에서 동작하는 스위치는 네트워크의 핵심 장비라고도 할 수 있다. 이 친구들은 기기에 내장되어 있는 mac주소를 기반으로 기능한다.
mac주소는 기본적으로 프레임을 받으면 mac주소를 인식하고 패킷을 전달하는 역할 을 하지만 그 외에도 논리적으로 네트워크를 분리하는 VLAN기능과 네트워크 루프를 방지하는 스패닝 트리 프로콜 기능등이 있다.

스위치는 네트워크의 통신을 중재하는 장비입니다.
스위치가 없던 시절에는 오래된 이더넷 네트워크에서는 패킷의 경합때문에 네트워크 성능저하 이슈가 존재했습나다.
이런 경합을 없애고 패킷을 동시에 여러 장비가 간섭없이 통신하도록 도와주는 장비가 스위치 입니다.
패킷들간에 간섭을 없애고 충돌을 방지하기 위해서 스위치에서는 누가 어느 위치에 있는지 파악하고 패킷을 정확히 보내는 기능이 핵심적인데, 라우팅은 mac주소를 통해 이루어지고, 이를 위해서 mac table을 유지하는것이 필수적입니다

스위치는 패킷을 받으면 해당 mac주소의 목적지의 포트로만 패킷을 전송합니다.
스위치는 mac table에 mac 주소가 저장이 되어 있어야 목적지 포트를 찾고 전송할 수 있습니다.
만약 스위치에 어떤 포트도 등록되어 있지 않다면 허브와 같이 들어온 모든 패킷을 다른 패킷에 전송하게 됩니다.

이를 효과 적으로 관리하기 위해서 mac주소를 관리 하는 3가지 동작방식이 있습니다

1. 플러딩
2. 어들레스 러닝
3. 포워딩/필터링

# 플러딩

스위치는 부팅하면 네트워크 관련 정보가 아무것도 없습니다.
이때는 스위치에서 중재를 하기위한 데이터가 없기 때문에 허브처럼 동작합니다.
들어온 모든 패킷을 연결 된 모든 패킷에 흘려보냅니다.

부팅할 때 뿐만 아니라 들어오는 패킷의 목적지  mac주소가 테이블에 없는 경우에도 동일하게 동작합니다.
플러딩은 정상적인 어쩔 수 없는 동작이지만, 스위치가 제 역할을 못하게 합니다.
패킷이 들어오면 스위치는 해당 패킷의 mac주소를 보고 학습해 테이블에 갱신시킵니다.

# 어드레스 러닝

전송에 참고하는 mac주소 테이블을 업데이트 하는 과정을 어드레스 러닝이라고 합니다,
어드레스 러닝은 패킷의 출발지 Mac주소를 이용합니다.
어떤 패킷이 특정포트에 들어오면 스위치에서는 해당패킷의 출발지 mac 주소와 포트번호를 mac 주소 테이블을 기록합니다.
예를 들어, 1번 포트에서 들어온 패킷의 출발지 Mac주소가 aaaa라면 1번 포트에 aaaa mac포트가 있겠구나 추론하는 형식입니다.

# 포워딩/필터링

스위치의 동작 방식은 매우 간단한데, 패킷이 들어온 경우 자신이 가진 mac테이블과 비교해, 맞는 정보가 있으면 매치되는 포트로 패킷을 포워딩합ㄴ다.
일치하지 않는 패킷에는 정보를 흘리지 않는데, 이를 필터링이라고 합니다.
스위치는 일반적인 유니캐스트에 대해서만 이렇게 동작합니다.
bum트래픽이라고 불리는 브로드캐스트와 언노운 유니캐스트, 멀티캐스트는 조금 다르게 동작합니다.
이는 통신 전 수행되는 arp 패킷 통신을 통해서 빈번히 업데이트 됩니다.


[[스위치_VLAN]]