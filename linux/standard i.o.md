
c 표준 라이브러리에서 STANDARD I.O 라는 함수들을 제공함
[[디바이스 드라이버]]

![[Pasted image 20230925153152.png]]


![[Pasted image 20230925153324.png]]
유닉스 i/o의 로우 함수들을 추상화 한 상위 함수들임


standard i/o 들은 stream의 형태로 파일들을 오픈함

![[Pasted image 20230925153659.png]]
표준 io는 시작과 동시에 세가지 스트림을 실행함


![[Pasted image 20230925153758.png]]
standard io 에서 파일을 출력하거나 저장때, 모든 입력에 즉각적으로 저장하는 것이 아니라, 메모리상에 임시 버퍼를 할당하고, 버퍼가 가득차거나 개행문자를 만날때만 저장,출력을 진행함.

이때, 메모리에 작성할 수 있기 때문에 속도도 빨라지고, 시스템콜을 적게 해도 돼어서 cpu에 부담도 적어지지만, 전원이 꺼지는 경우 모든 데이터가 날아가기 때문에 위험함.

이때 사용되는 것이 fflush로 buffer에 있는 모든 내용이 즉시 저장됨.
fsync와 같은 함수는 파일 디스크립터가 가르키고 있는 파일을 즉시 저장함.


gpt 왈 :

>`fflush`와 `fsync`는 데이터를 디스크에 쓰는 데 사용되는 함수 또는 명령입니다. 이 두 함수는 파일 시스템과 버퍼 관리에 관련이 있으며 데이터의 지속성과 관련이 있습니다. 그러나 사용되는 환경 및 목적에 따라 다르게 작동합니다
>
1. `fflush`:
    
    - `fflush` 함수는 C 언어에서 사용되는 함수로, 버퍼에 있는 데이터를 파일에 즉시 쓰는 데 사용됩니다.
    - 주로 텍스트 파일을 다룰 때 사용되며, 버퍼에 있는 데이터를 강제로 파일로 쓰기 위해 호출됩니다.
    - 버퍼에 있는 데이터를 파일로 쓰면 디스크에 데이터가 영구적으로 저장됩니다.
    - `fflush` 함수는 파일 스트림(`FILE` 구조체를 사용)에 대해서 사용되며, 파일을 열 때 버퍼링 동작을 변경할 수 있습니다.
      
2. `fsync`:
    
    - `fsync`는 리눅스와 유닉스 계열 운영 체제에서 사용되는 시스템 콜(System Call)로, 파일 디스크립터가 가리키는 파일에 대해 데이터를 강제로 디스크에 쓰기 위해 사용됩니다.
    - 주로 파일 시스템 또는 데이터베이스와 같이 중요한 데이터의 지속성을 보장해야 할 때 사용됩니다.
    - `fsync`을 호출하면 운영 체제는 해당 파일의 모든 변경 사항을 디스크에 쓰고 파일 시스템 캐시를 갱신합니다.
      
      요약하면, `fflush`는 C 라이브러리 함수로 버퍼된 데이터를 파일로 쓸 때 사용되며, `fsync`는 시스템 콜로 파일 디스크립터가 가리키는 파일에 대해 디스크에 데이터를 강제로 쓸 때 사용됩니다. `fsync`은 일반적으로 데이터의 지속성을 보장하기 위해 사용되며, 보다 안전한 파일 기록을 위해 필요한 경우에 사용됩니다.




