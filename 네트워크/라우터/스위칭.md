패킷이 들어와 라우터 테이블을 참조하고 최적의 경로를 찾아 라우터 외부로 포워딩 하는 작업을 스위칭 이라고 합니다.
이는 2계층 스위치랑 혼동될 수 있는데, 이는 3계층 장비에서 일어납니다.

패킷의 정보를 테이블에서 참고하여 라우팅을 설정하지만, 이가 부정확하거나 일치하지 않는경우가 있기 때문에 많은 요소들을 고려해야 합니다.

예를 들어 10.1.19의 ip의 목적지를 가진 패킷이 라우터에 들어온 경우, 해당 목적지와 가장 비슷한 ip를 가진 테이블 열을 탐색합니다.
일치하는 열이 있을 수도 있지만 없을경우, longest prefix match기법을 사용하여 가장 가까운 경로를 선택합니다.

이는 단순히 정확히 일치하는 주소를 찾는 것보다 더 리소스를 많이 소모하는 작업입니다.
기기에 많은 부하를 줄 수 있기 때문에 다양한 방법을 통해서 이를 해소하는데, 이중 하나가 캐쉬화 입니다.
한번 들어온 목적지는 캐시에 저장하고, 다음패킷이 들어오면 캐시를 먼져 탐색하는데, 이는 같은 주소를 가진 패킷이 1회이상 왕복할 확률이 더 높기 때문입니다.

## 라우팅, 스위칭 우선순위

일반적으로 경로 정보를 모아놓은 "토폴로지 테이블" 과 이중에서 우선순위를 지정해 가장 좋은 경로만 모아놓은 테이블을 라우팅 테이블이라고 합니다.

일반적으로 
자동 입력 경로 정보>> 관리자 지정 경로정보>>다이내믹 입력 정보 
순으로 우선순위가 높습니다.

만약 경로정보로 얻은 소스가 같아 가중치 값이 같은 경우, 코스트 값으로 우선순위를 정합니다.
코스트 값가지 동일한 경우 ECMP(Equal-Cost-Multi-Path)기능으로 동일한 코스트 값을 가진 경로값 정보를 모두 활용해 트래픽을 분산합니다.

우선순위 표는 다음과 같습니다
1. 롱키스트 매치 <--- 테이블에서 가장 인접한 ip를 가지고 있는 경로
2. AD(관리 거리)<--- 테이블 내에서 정보를 받아온 방법을 나눠서 우선순위를 배정
3. 코스트 <--- 같은 ad를 가진 값들 중에서 코스트가 더 낮은 경우
4. ECMP <--- 나눠서 분산 전송







