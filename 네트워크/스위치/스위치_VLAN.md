
VLAN은 물리적 배치와 상관없이 LAN을 논리적으로 분할, 구성하는 기술입니다.
기업과 같이 여러개의 부서가 독자적인 통신망을 사용하려고 할 떄 사용할 수 있습니다.
VLAN을 나누면 하나의 장비가 서로 다른 네트워크를 갖도록 분할 할 수 있습니다.

또한 이들은 완전 분할 된 네트워크로 인식되므로 브로드캐스트와 2계층 통신을 할 수 없고, 3계층 장비의 도움을 필요로합니다.
또한, 여러대의 스위치를 분리해도 VLAN을 통해서 분리된 포트들을 묶어서,  동일한 네트워크에서 동작하는것처럼 구성할 수 있습니다.

# VLAN의 종류

VLAN은 포트 기반의 VLAN과 MAC 주소기반 VLAN이 있습니다.
초기의 VLAN은 고가의 스위치 낭비를 막고 여러 네트워크를 사용하는 것이 목적이였습니다

당시에 사용되던 분할 방식을  포트기반 VLAN이라고 합니다. 그러나 부서간 자리이동이 빈번해지자 새로운 분할 방식이 생겼는데 이는 MAC주소 기반 포트분할 입니다. 
MAC 주소별로 VLAN을 적용해 다른 포트에 연결하더라도 기존 디바이스의 MAC주소를 기반으로 VLAN을 지정합니다.

대다수의 포트분할 방식은 포트기반 VLAN입니다.


![](https://i.imgur.com/XGlVagE.png)


# VLAN모드 동작방식(Trunk/Access) 동작방식

VLAN을 통해서 스위치를 분리하면, 다른 로컬네트워크에 접근 하듯이 통신해야합니다.(3계층)
VLAN을 사용하면, 스위치를 효율적으로 연걸 할 수 있다는 장점이 있지만, 만약 두개 이상의 스위치에서 VLAN을 통해 공유되는 네트워크를 조성하려 한다면, 각각의 개별 네트워크는 마치 물리적인 스위치 분할 처럼 각각의 포트를 통해 연결 해야합니다.

![](https://i.imgur.com/5itaIAY.png)

이는 포트의 낭비를 의미합니다.

이를 해결하는 것이 VLAN태그 기능입니다.
태그 기능은 하나의 포트에 여러개의 VLAN을 함께 전송할 수 있게 합니다.
이런 포트를 태그포트 또는 트렁크 포트라고 합니다.

여러개의 VLAN을 동시에 전송해야 하는 태그 포트는 통신할 때 이더넷 프레임 중간에 VLAN ID를 끼워서 전송하며, 수신자에서는 VLAN ID를 제거하며 해당 패킷을 VLAN으로 보낼 수 있습니다.

태그 포트(트렁크 포트)를 사용하게 되면서 포트의 낭비를 줄일 수 있게 됐습니다.
![](https://i.imgur.com/Bq8NSlW.png)

패킷에 VLAN 태그를 추가하여 보내면서 스위치 패킷 전송에 사용하는 MAC주소 테이블에도 다른 VLAN들과 섞이지 않게 하기 위해서 MAC테이블에 VLAN을 지정하는 필드가 추가되었습니다.
덕분에 VLAN별로 MAC주소 테이블이 존재하는 것처럼 동작하게 됩니다.

일반적인 포트를 "언태그" 또는 "액세스" 포트라고 하고  VLAN을 한꺼번에 통신하도록  하는 포트를 태그 포트 또는 트렁크 포트라고 부릅니다.
태그포트는 여러개의 VLAN,즉 네트워크를 하나의 물리적인 포트로 전달하는 데 사용되고 언태그 포트는 하나의 VLAN에 속한 경우에만 사용됩니다.



